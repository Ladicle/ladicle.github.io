<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>NUC on Ladicle</title><link>https://ladicle.com/tags/nuc/</link><description>Recent content in NUC on Ladicle</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Mon, 26 Aug 2019 21:56:24 +0900</lastBuildDate><atom:link href="https://ladicle.com/tags/nuc/index.xml" rel="self" type="application/rss+xml"/><item><title>外出先でも快適なお家k8sクラスタを構築する</title><link>https://ladicle.com/post/k8s-home-cluster/</link><pubDate>Mon, 26 Aug 2019 21:56:24 +0900</pubDate><guid>https://ladicle.com/post/k8s-home-cluster/</guid><description>Table of Contents 1 なぜお家Kubernetesクラスタか 2 Workerのハードウェア構成と価格 3 マシンにUbuntuサーバをインストールする 3.1 Live USBの作成 3.2 インストーラの進化 3.3 LVMのディスク容量を増やす 4 Kubernetesの構成検討と構築 4.1 cri-oのセットアップ 4.2 kubeadmによるクラスタ構築 4.2.1 事前準備 4.2.2 Master/Workerの構築 4.3 ciliumのCNIプラグインを適用する 4.4 MetalLBの構築 5 CloudflareのArgo経由でSSHする 5.1 Server設定 5.2 Client設定 5.3 Cloudflare Accessでアクセスユーザを制限する 6 kubeadmによるクラスタアップグレード 6.1 CNIプラグインのアップグレード 1 なぜお家Kubernetesクラスタか なんでもクラウドサービスな時代だが、やはりそれなりのスペックを求めるとそれなりのお値段になってしまう。また、サービスによっては下回りの構成変更の柔軟性や新機能が利用できるようになるまでラグもサービスに依存する。そんな状況を鑑みると、実験場として請求書に怯えることなく使えるお家クラスタが欲しくなってくるものだ。
2 Workerのハードウェア構成と価格 Figure 1: (左): 届いたパーツ群、(右): 配線が完了したNUC
Master用のNUCは自宅のものを再利用したため、ここには含まれていない。こちらのスペックは数世代前のi5 NUCで32GBメモリ、2TBのディスクを積んでいる。メモリが市場に溢れてる今が買い時ということで8GBと悩んだ結果16GBにした。ツクモで全て買おうとしていたが購入制限に引っかかったので1台だけソフマップとなっている。また、スイッチのポートも足りなくなってきたので一緒に購入した(最近のNETGEARは謎にスマホアプリから設定変更や状態確認ができて面白い。
Table 1: パーツと価格 Shop Item Price(JPY) Number Total(JPY) TSUKUMO NUC8I3BEH (BOXNUC8I3BEH) 35,366 2 70,732 CT2K8G4SFS824A (Crucial 16GB:8GBx2) 11,858 3 35,574 WDS500G2B0B (WD 500GB SSD) 6,980 3 20,940 Sofmap NUC8I3BEH (BOXNUC8I3BEH) 35,366 1 35,366 Amazon GS105E-200JPS (NETGEAR Switching Hub 5port) 3,570 1 3,570 BSACC0802BKA (BUFFALO power cable 3pin/2pin plug) 482 3 1,446 Yodobashi LA-SL6-005BK (SANWA SUPPLY CAT6 LAN cable 0.</description></item></channel></rss>